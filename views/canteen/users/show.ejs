<%- include(`${partials}/head/app`) %>
<%- include(`${partials}/breadcrumb`, {href: '/canteen',	   text: 'Canteen'}) %>
<%- include(`${partials}/breadcrumb`, {href: '/canteen/users', text: 'Users'}) %>
<%- include(`${partials}/breadcrumb`) %>
<%- include(`${partials}/reload`) %>
<%- include(`${partials}/head/navbar/close`) %>
<section class='container'>
    <ul class="nav nav-tabs" id="mainTab" role="tablist">
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Menu
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <%- include(`${partials}/users/show/menu_buttons`) %>
                <%- include(`${partials}/notes/menu_add`) %>
            </div>
        </li>
        <%- include(`${partials}/users/show/tab_heads`) %>
        <%- include(`${partials}/tab_head`, {id: 'paid_in',  title: 'Paid In',  spinner: 'paid_in',  count_id: 'paid_in',  permission: 'access_movements'}) %>
        <%- include(`${partials}/tab_head`, {id: 'paid_out', title: 'Paid Out', spinner: 'paid_out', count_id: 'paid_out', permission: 'access_movements'}) %>
        <%- include(`${partials}/tab_head`, {id: 'notes',    title: 'Notes',    spinner: 'notes',    count_id: 'note',     permission: 'access_notes'}) %>
    </ul>
    <div class="tab-content pt-3" id="myTabContent">
        <%- include(`${partials}/users/show/tab_bodies`) %>
        <% if (permissions.access_movements) { %>
            <div class="tab-pane fade" id="paid_in" role="tabpanel" aria-labelledby="paid_in-tab">
                <table class="table table-sm table-hover">
                    <thead class="thead-dark">
                        <th class="w-60" onclick="sortTable(0, 'tbl_paid_in')">Date</th>
                        <th class="w-20" onclick="sortTable(1, 'tbl_paid_in')">Amount</th>
                        <th class="w-20" onclick="sortTable(2, 'tbl_paid_in')">Type</th>
                        <th><i class='fas fa-search'></i></th>
                    </thead>
                    <tbody id="tbl_paid_in"></tbody>
                </table>
            </div>
            <div class="tab-pane fade" id="paid_out" role="tabpanel" aria-labelledby="paid_out-tab">
                <table class="table table-sm table-hover">
                    <thead class="thead-dark">
                        <th class="w-60" onclick="sortTable(0, 'tbl_paid_out')">Date</th>
                        <th class="w-20" onclick="sortTable(1, 'tbl_paid_out')">Amount</th>
                        <th class="w-20" onclick="sortTable(2, 'tbl_paid_out')">Type</th>
                        <th><i class='fas fa-search'></i></th>
                    </thead>
                    <tbody id="tbl_paid_out"></tbody>
                </table>
            </div>
        <% } %>
        <%- include(`${partials}/notes/tab_body`) %>
    </div>
    <div id="div_modals">
        <%- include(`${partials}/users/show/modals`) %>
    </div>
</section>
<%- include(`${partials}/foot/app`) %>
<script src='/js/tabs.js'></script>
<script src="/js/data/addFormListener.js"></script>
<script src="/js/data/send.js"></script>
<script>showTab('<%= tab %>');</script>

<%- include(`${partials}/users/show/scripts`) %>

<% if (permissions.access_movements) { %>
    <script src='/js/canteen/users/show/getMovements.js'></script>
    <script async>getMovements('user_id_to')</script>
    <script async>getMovements('user_id_from')</script>
<% } %>
<%- include(`${partials}/foot/elements/htmlClose`) %>