<%- include(`${partials}/head/app`, {text: 'Canteen'}) %>
<%- include(`${partials}/breadcrumb`, {href: '/sales', text: 'Sales'}) %>
<%- include(`${partials}/breadcrumb`) %>
<%- include(`${partials}/reload`) %>
<%- include(`${partials}/head/components/close`) %>
<section class='container'>
    <ul class="nav nav-tabs" id="mainTab" role="tablist">
        <%- include(`${partials}/tab_head`, {id: 'details',  title: 'Details',  spinner: 'sale'}) %>
        <%- include(`${partials}/tab_head`, {id: 'lines',    title: 'Lines',    spinner: 'sale_lines', count_id: 'line'}) %>
        <%- include(`${partials}/tab_head`, {id: 'payments', title: 'Payments', spinner: 'payments',   count_id: 'payment'}) %>
    </ul>
    <div class="tab-content pt-3" id="myTabContent">
        <div class="tab-pane fade" id="details" role="tabpanel" aria-labelledby="details-tab">
            <%- include(`${partials}/inputs/display`, {id: 'sale_createdAt', title: 'Date'}) %>
            <%- include(`${partials}/inputs/display`, {id: 'sale_user',      title: 'User'}) %>
            <%- include(`${partials}/inputs/display`, {id: 'sale_status',    title: 'Status'}) %>
        </div>
        <div class="tab-pane fade" id="lines" role="tabpanel" aria-labelledby="lines-tab">
            <table class="table table-sm table-hover">
                <thead class="thead-dark">
					<th class='w-35' onclick='sortByRow(this, getSaleLines)' data-sort_col='createdAt'>Date/Time<span class='sort_ind float-end'></span></th>
					<th class='w-25' onclick='sortByRow(this, getSaleLines)' data-sort_col='item_id'  >Item<span class='sort_ind float-end'></span></th>
					<th class='w-10' onclick='sortByRow(this, getSaleLines)' data-sort_col='qty'      >Qty<span class='sort_ind float-end'></span></th>
					<th class='w-15' onclick='sortByRow(this, getSaleLines)' data-sort_col='price'    >Price<span class='sort_ind float-end'></span></th>
					<th class='w-15'>Total</th>
                    <th><i class='fas fa-search'></i></th>
                </thead>
                <tbody id="tbl_lines"></tbody>
            </table>
        </div>
        <div class="tab-pane fade" id="payments" role="tabpanel" aria-labelledby="payments-tab">
            <table class="table table-sm table-hover">
                <thead class="thead-dark">
					<th class='w-40' onclick='sortByRow(this, getPayments)' data-sort_col='createdAt'>Date/Time<span class='sort_ind float-end'></span></th>
					<th class='w-15' onclick='sortByRow(this, getPayments)' data-sort_col='amount'   >Amount<span class='sort_ind float-end'></span></th>
					<th class='w-15' onclick='sortByRow(this, getPayments)' data-sort_col='method'   >Method<span class='sort_ind float-end'></span></th>
					<th class='w-30' onclick='sortByRow(this, getPayments)' data-sort_col='user_id'  >User<span class='sort_ind float-end'></span></th>
                    <th><i class='fas fa-search'></i></th>
                </thead>
                <tbody id="tbl_payments"></tbody>
            </table>
        </div>
    </div>
</section>
<%- include(`${partials}/foot/app`) %>
<script>showTab('<%= tab %>');</script>
<script src='/js/canteen/sales/show/view.js'></script>
<script async>getSale()</script>
<script src='/js/canteen/sales/show/lines/view.js'></script>
<script async>getSaleLines()</script>
<script src='/js/canteen/sales/show/payments/view.js'></script>
<script async>getPayments()</script>
<%- include(`${partials}/foot/components/htmlClose`) %>