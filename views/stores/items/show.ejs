<% include ../../partials/head/full %>
<section class='mb-2'>
    <nav class='navbar navbar-expand navbar-light bg-nav'>
        <ul class='navbar-nav mr-auto'>
            <li class='nav-item'>
                <a class='nav-link stores_nav' href='/stores'>
                    Stores
                </a>
            </li>
            <li class='nav-item'>
                <a class='nav-link stores_nav' href='/stores/items'>
                    Items
                </a>
            </li>
            <li class='nav-item'>
                <a class='nav-link stores_nav' href='/stores/items/<%= item.item_id %>'>
                    <%= item._description %>
                </a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle stores_nav" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Options
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <% if (permissions.item_edit) { %><%- include('../../partials/edit') %><% } %>
                    <% include ../../partials/notes/menu_add %>
                    <% if (permissions.item_delete) { %><%- include('../../partials/delete') %><% } %>
                    <% if (permissions.size_add) { %>
                        <a class='dropdown-item' href='javascript:add("sizes",{"queries":"item_id=<%= item.item_id %>","height":600})'>
                            Add Size
                        </a>
                    <% } %>
                </div>
            </li>
        </ul>
    </nav>
</section>
<section class='container'>
    <ul class="nav nav-tabs" id="mainTab" role="tablist">
        <li class="nav-item">
            <a class="nav-link" id="details-tab" data-toggle="tab" href="#details" role="tab" aria-controls="details" aria-selected="true">
                Details
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="sizes-tab" data-toggle="tab" href="#sizes" role="tab" aria-controls="sizes" aria-selected="true">
                Sizes (<span id='size_count'></span>)
            </a>
        </li>
        <% include ../../partials/notes/tab_head %>
    </ul>
    <div class="tab-content pt-3" id="myTabContent">
        <div class="tab-pane fade" id="details" role="tabpanel" aria-labelledby="details-tab">
            <div class="container">
                <%- include('../../partials/inputs/display', {title: 'Description', text: item._description}) %>
                <%- include('../../partials/inputs/display', {title: 'Category',    text: item.category._category}) %>
                <div class="input-group mb-1">
                    <div class="input-group-prepend w-30">
                        <span class="input-group-text w-100">Group</span>
                    </div>
                    <p class="form-control"><% if (item.group) { %><%= item.group._group %><% } %></p>
                </div>
                <div class="input-group mb-1">
                    <div class="input-group-prepend w-30">
                        <span class="input-group-text w-100">Type</span>
                    </div>
                    <p class="form-control"><% if (item.type) { %><%= item.type._type %><% } %></p>
                </div>
                <div class="input-group mb-1">
                    <div class="input-group-prepend w-30">
                        <span class="input-group-text w-100">Sub Type</span>
                    </div>
                    <p class="form-control"><% if (item.subtype) { %><%= item.subtype._subtype %><% } %></p>
                </div>
                <div class="input-group mb-1">
                    <div class="input-group-prepend w-30">
                        <span class="input-group-text w-100">Gender</span>
                    </div>
                    <p class="form-control"><% if (item.gender) { %><%= item.gender._gender %><% } %></p>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="sizes" role="tabpanel" aria-labelledby="sizes-tab">
            <div class="container">
                <%- include('../../partials/spinner', {id: 'items'}) %>
                <table class='table table-sm table-hover w-100'>
                    <thead class='thead-dark'>
                        <th class='w-50' onclick='sortTable(0, "sizeTable")'><%= item._size_text %></th>
                        <th class='w-50' onclick='sortTable(1, "sizeTable")'>Stock</th>
                        <th><i class='fas fa-search'></i></th>
                    </thead>
                    <tbody id='sizeTable'>
                    </tbody>
                </table>
            </div>
        </div>
        <% include ../../partials/notes/tab_body %>
    </div>
</section>
<% include ../../partials/foot/full %>
<script src='/js/get/sizes.js'></script>
<script>
    window.addEventListener( "load", function () {
        addFormListener(
            'deleteForm',
            'DELETE',
            '/stores/items/<%= item.item_id %>',
            {redirect: '/stores/items'}
        );
    });
</script>
<script async>getSizes(<%= item.item_id %>)</script>
<% include ../../partials/foot/htmlClose %>
