<% include ../../partials/head/full %>
<section class="mb-2">
	<nav class="navbar navbar-expand navbar-light bg-nav">
		<ul class="navbar-nav mr-auto">
			<li class="nav-item">
				<a class="nav-link stores_nav" href="/stores">Stores</a>
			</li>
			<li class="nav-item">
				<a class="nav-link stores_nav" href="/stores/requests">Requests</a>
			</li>
		</ul>
	</nav>
</section>
<section>
	<div class="container">
		<div class="input-group mb-2">
			<div class="input-group-prepend">
				<label class="input-group-text" for="complete">Completed Requests</label>
			</div>
			<select class="custom-select" id='complete' onchange=filterSelects()>
				<option value="1" <% if (Number(query.complete) === 1) { %>selected<% } %> >Include</option>
				<option value="2" <% if (Number(query.complete) === 2) { %>selected<% } %> >Exclude</option>
				<option value="3" <% if (Number(query.complete) === 3) { %>selected<% } %> >Only</option>
			</select>
		</div>
		<table class="table table-sm table-hover mx-auto w-100">
			<thead class="thead-dark">
				<th class="w-40" onclick="sortTable(0, 'requestTable')">For</th>
				<th class="w-40" onclick="sortTable(1, 'requestTable')">Date</th>
				<th class="w-10" onclick="sortTable(2, 'requestTable')">Lines</th>
				<th class="w-10">Complete</th>
				<th><i class='fas fa-search'></i></th>
			</thead>
			<tbody id="requestTable">
				<% if (requests) requests.forEach(request => { %>
					<tr>
						<td>
							<a class='float-right btn btn-sm btn-primary' href="/stores/users/<%= request.requested_for %>">
								<i class='fas fa-search'></i>
							</a>
							<%= request._for.rank._rank %> <%= request._for._name %>, <%= request._for._ini %>
						</td>
						<td data-sort="<%= request._date.getTime() %>">
							<%= request._date.toDateString() %>
						</td>
						<td>
							<%= request.lines.length %>
						</td>
						<td>
							<input class="form-control form-control-sm" type="checkbox" <% if (request._complete) { %>checked <% } %>disabled>
						</td>
						<td>
							<a class='btn btn-sm btn-primary' href="/stores/requests/<%= request.request_id %>">
								<i class='fas fa-search'></i>
							</a>
						</td>
					</tr>
				<% }); %>
			</tbody>
		</table>
	</div>
</section>
<% include ../../partials/foot/full %>
<script>
	function filterSelects() {
        filter(['complete'], "/stores/requests");
	};
</script>
<% include ../../partials/foot/htmlClose %>